
########  CODE FOR FIGURE 2, SMITH ET AL., NFVAP  ########

## Last updated 2019.01.15 by M.C. Mims


#set working directory
setwd("E:/Meryl - Professional/Projects/Active Projects/USGS National Fishes Rarity Project/Smithetal_AOO_2018/Figures/Figure2")


## Read count data for species x family

#NOTE: input files should be sorted in order of desired appearance on x-axis
# current csv files are ordered by species count (highest to lowest) for Mims et al.; 
# a column is provided in Smith et al. to match order in Mims et al. (Orderby_MimsSppCount)

CountsMims <- read.csv("Figure2_Mimsetal2010_SpeciesxFamily.csv", header=TRUE)
CountsSmith <- read.csv("Figure2_Smithetal_SpeciesxFamily.csv", header=TRUE)

#subset to only families from Mims et al with >1 species
CountsMims26 <- CountsMims[c(1:26),c(2:5)]
row.names(CountsMims26) <- CountsMims[c(1:26),1]
CountsSmith26 <- CountsSmith[c(1:26),c(2:6)]
row.names(CountsSmith26) <- CountsSmith[c(1:26),1]

#set color columns to characters for plotting
MimsCol <- as.character(CountsMims26$MimsCol)
SmithCol <- as.character(CountsSmith26$SmithCol)

## Bar plots for exports; figures processed for publication outside R environment (Adobe photoshop)
#gap.barplot may achieve same effect, but we were not successful with overlaying plots with that function


# First plot ("short") created to show differences among species counts in Smith et al.

png("Figure2B_short.png", width=9, height=7, units="in", res=300)
plot.new()
barplot(CountsMims26$Species, xaxt="n", xlab="", ylim=c(-1,50), col=MimsCol, ylab="Species counts", space=0)
text(seq(0.5, 26,by=1), par("usr")[3]-0.25, 
     srt = 60, adj= 1, xpd = TRUE,
     labels = paste(row.names(CountsMims26)), cex=0.8)
par(new=TRUE)
barplot(CountsSmith26$Species, ylim=c(-1,50), xaxt="n", xlab="", yaxt="n", col=SmithCol, space=0)
dev.off()


# Second plot ("tall") created to show high species counts for biggest families from Mims et al. 2010

plot.new()
png("Figure2B_tall.png", width=9, height=7, units="in", res=300)
barplot(CountsMims26$Species, xaxt="n", xlab="", ylim=c(-1,250), col=MimsCol, ylab="Species counts", space=0)
par(new=TRUE)
barplot(CountsSmith26$Species, ylim=c(-1,250), xaxt="n", xlab="", yaxt="n", col=SmithCol, space=0)
dev.off()
